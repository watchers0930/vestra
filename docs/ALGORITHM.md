# VESTRA 핵심 알고리즘 기술 명세서

**문서 버전**: 1.0
**작성일**: 2026-02-24
**분류**: 기술보증기금(KIBO) 심사용 기술 문서 / 특허 출원 참조용

---

## 1. 기술 개요

VESTRA는 한국 부동산 등기부등본을 자동 분석하는 AI 자산관리 플랫폼입니다.
핵심 기술은 **AI/LLM에 의존하지 않는 3개의 독자 엔진**으로 구성됩니다:

| 엔진 | 파일 | 코드량 | AI 의존 |
|------|------|--------|---------|
| 등기부등본 파싱 엔진 | `registry-parser.ts` | 592줄 | 없음 |
| 4단계 검증 엔진 | `validation-engine.ts` | 700줄 | 없음 |
| 리스크 스코어링 엔진 | `risk-scoring.ts` | 511줄 | 없음 |

총 **1,803줄의 순수 TypeScript** 독자 알고리즘입니다.

---

## 2. 등기부등본 자동 파싱 엔진

### 2.1 문제 정의

한국 부동산 등기부등본은 비정형 텍스트 문서로, 다양한 형식(인터넷등기소, 법원등기, OCR)으로 존재합니다.
이를 구조화된 데이터로 변환하는 것은 아래 난제를 포함합니다:

- 띄어�기 가변성 (`갑구` vs `갑 구`)
- 다중 날짜 형식 (`2023년 5월 15일`, `2023.05.15`, `2023-05-15`)
- 다중 금액 형식 (`금 480,000,000원`, `금3억5,000만원`, `금3억원`)
- 다줄 항목 누적 (한 등기 항목이 여러 줄에 걸침)
- 말소/현행 구분

### 2.2 알고리즘 구조

```
입력: 등기부등본 원문 텍스트 (string)
│
├── [정규화] CRLF→LF, TAB→공백
│
├── [섹션 분리] splitSections()
│   ├── 표제부 감지: 【표제부】, [표제부], "표 제 부" (3가지 패턴)
│   ├── 갑구 감지: 동일 3가지 패턴
│   └── 을구 감지: 동일 3가지 패턴
│
├── [표제부 파싱] parseTitle()
│   ├── 주소 추출: /[가-힣]+[시도]\s+[가-힣]+[시군구]/
│   ├── 면적 추출: /[\d.]+\s*㎡/
│   ├── 구조 추출: 철근콘크리트|철골|벽돌|목조 등
│   ├── 용도 추출: 아파트|다세대|오피스텔 등
│   └── 대지권비율 추출
│
├── [갑구 파싱] parseGapgu()
│   ├── 항목 경계 감지: 순위번호(숫자) 또는 권리키워드+날짜
│   ├── 다줄 누적: 후속 줄에서 날짜/권리자/유형 보완
│   ├── 권리 분류: 18개 키워드 → 위험도 매핑
│   └── 말소 감지: /말소|말소기준등기/
│
├── [을구 파싱] parseEulgu()
│   ├── 갑구와 동일 구조 + 금액 추출
│   ├── 금액 추출: 6가지 한국식 금액 패턴 자동 인식
│   └── 권리 분류: 13개 키워드 → 위험도 매핑
│
└── [요약 생성] buildSummary()
    ├── 활성/말소 건수 집계
    ├── 근저당/전세 합산
    ├── 12개 위험 플래그 설정
    └── 소유권이전 횟수 계산

출력: ParsedRegistry {title, gapgu[], eulgu[], summary}
```

### 2.3 핵심 기술 (특허 대상)

**다단계 항목 파싱 알고리즘**:
1. 각 줄을 순위번호 패턴 또는 키워드+날짜 조합으로 항목 시작점 감지
2. 항목 시작이 아닌 줄은 현재 항목에 누적 (다줄 처리)
3. 누적 중 빠진 필드(날짜, 권리자, 금액)를 후속 줄에서 자동 보완
4. 권리유형은 길이 내림차순 매칭 (더 구체적인 키워드 우선)

**한국식 금액 자동 변환 엔진**:
```
패턴 1: "금 480,000,000원" → 480,000,000
패턴 2: "금3억5,000만원" → 350,000,000
패턴 3: "금3억원" → 300,000,000
패턴 4: "금5,000만원" → 50,000,000
패턴 5: "XXX,XXX,XXX원" → 직접 파싱
패턴 6: 7자리 이상 순수 숫자 → 직접 파싱
```

---

## 3. 4단계 데이터 검증 엔진

### 3.1 개요

파싱 결과의 신뢰도를 정량적으로 평가하는 독자 검증 시스템입니다.
4개 검증 계층으로 구성되며, 총 23개 검증기가 작동합니다.

### 3.2 검증 계층 구조

```
Layer 1: 포맷 및 타입 검증 (Format & Type) ─── 6개 검증기
Layer 2: 합계 및 산술 검증 (Arithmetic)     ─── 6개 검증기
Layer 3: 문맥 및 규칙 검증 (Context & Rule) ─── 7개 검증기
Layer 4: 크로스체크 검증 (Cross-Check)       ─── 4개 검증기
```

### 3.3 Layer 1: 포맷 및 타입 검증

| 검증기 | 검증 내용 | 심각도 |
|--------|----------|--------|
| DateFormat | 날짜 YYYY.MM.DD, 범위 1900~2035 | error |
| AmountFormat | 금액 양수, 100만~500억원 범위 | error/warning |
| EntryOrder | 순위번호 순차, 중복/음수 없음 | warning/error |
| HolderName | 권리자명 2~30자, 한글/영문/법인명 | info/warning |
| RiskType | danger\|warning\|safe\|info 열거형 | error |
| SectionCompleteness | 표제부 주소, 갑구/을구 존재 | warning |

### 3.4 Layer 2: 합계 및 산술 검증

| 검증기 | 검증 수식 |
|--------|----------|
| MortgageSum | Σ(활성 근저당 금액) = summary.totalMortgageAmount |
| JeonseSum | Σ(활성 전세권 금액) = summary.totalJeonseAmount |
| TotalClaims | totalMortgage + totalJeonse = totalClaimsAmount |
| MortgageRatio | totalMortgage / estimatedPrice × 100 = riskScore.mortgageRatio |
| ActiveEntryCounts | 배열.filter(!cancelled).length = summary.activeEntries |
| OwnershipTransferCount | 갑구.filter(소유권이전 && !cancelled).length = summary.count |

### 3.5 Layer 3: 문맥 및 규칙 검증

| 검증기 | 부동산 법리 규칙 |
|--------|----------------|
| ChronologicalOrder | 등기 날짜는 순위번호 순서대로 비감소 |
| CancellationLogic | 말소등기는 대응하는 원본 등기가 존재해야 함 |
| OwnershipChain | 활성 소유권이전/보존 항목이 최소 1개 존재 |
| MortgageAfterSeizure | 압류 이후 근저당 설정 = 비정상 거래 경고 |
| TrustMortgageConflict | 신탁 이후 근저당 설정 = 수탁자 동의 확인 |
| FirstEntryRule | 갑구 1번 = 소유권보존 또는 소유권이전 |
| EulguWithoutOwnership | 소유권 없이 을구만 존재 = 구조 이상 |

### 3.6 Layer 4: 크로스체크 검증

| 검증기 | 교차 검증 대상 |
|--------|--------------|
| SummaryFlags | ParseSummary 9개 불리언 vs 실제 엔트리 재계산 |
| EstimatedPriceSanity | 추정가격 5천만~500억 범위 |
| RiskScoreConsistency | 리스크팩터 존재 ↔ 파싱플래그 true 양방향 |
| AiOpinionRelevance | AI의견에 실제 위험요소 키워드 포함 여부 |

### 3.7 검증 점수 산출

```
score = (통과 검사 수 / 총 검사 수) × 100
isValid = (error 심각도 이슈 수 === 0)
```

---

## 4. 리스크 스코어링 알고리즘

### 4.1 스코어링 모델

**가중치 감점 모델**: 100점 만점에서 위험 요인별 감점

```
최종 점수 = max(0, 100 - Σ감점)
```

### 4.2 12개 평가 함수

| # | 평가 항목 | 최대 감점 | 심각도 |
|---|----------|----------|--------|
| 1 | 근저당 비율 (시세 대비) | -30 | critical |
| 2 | 압류 등기 | -25/건 | critical |
| 3 | 가압류 등기 | -20/건 | critical |
| 4 | 가처분 등기 | -15/건 | high |
| 5 | 경매개시결정 | -30 | critical |
| 6 | 가등기 | -10 | medium |
| 7 | 신탁등기 | -15 | high |
| 8 | 소유권 이전 빈도 | -15 | high |
| 9 | 선순위채권 합산 비율 | -25 | critical |
| 10 | 임차권등기명령 | -20 | critical |
| 11 | 예고등기 | -12 | high |
| 12 | 환매등기 | -10 | medium |

### 4.3 등급 체계

| 등급 | 점수 범위 | 의미 |
|------|----------|------|
| A | 85~100 | 안전 |
| B | 70~84 | 양호 |
| C | 50~69 | 주의 |
| D | 30~49 | 위험 |
| F | 0~29 | 매우위험 |

### 4.4 근저당 비율 평가 상세

```
ratio = totalMortgageAmount / estimatedPrice × 100

ratio > 120% → -30점 (깡통주택 극도 위험)
ratio > 100% → -25점 (시세 초과)
ratio >  80% → -20점 (고위험)
ratio >  70% → -10점 (주의)
ratio >  50% →  -5점 (모니터링)
ratio ≤  50% →   0점 (안전)
```

---

## 5. 기술 스택

| 구분 | 기술 | 버전 |
|------|------|------|
| 언어 | TypeScript | 5.x |
| 프레임워크 | Next.js (App Router) | 16.1.6 |
| UI | React | 19.2.3 |
| 스타일링 | Tailwind CSS | 4.x |
| DB | Prisma + SQLite | 6.x |
| 인증 | NextAuth.js | 5.x |
| 테스트 | Vitest | 4.x |
| AI (보조) | OpenAI GPT-4o | - |
| 배포 | Vercel | - |

---

## 6. 독창성 및 경쟁 우위

1. **AI 미사용 핵심 분석**: 파싱, 검증, 스코어링 3개 엔진이 순수 TypeScript로 구현됨
2. **4단계 검증 체계**: 포맷→산술→문맥→크로스체크 계층적 검증은 업계 최초
3. **한국 부동산법 특화**: 31개 등기 키워드 분류, 6가지 한국식 금액 패턴 인식
4. **12개 위험 평가 항목**: 한국 부동산 거래에서 발생 가능한 모든 위험을 정량화
5. **경쟁사 모방 장벽**: 동일 엔진 구축에 6개월 이상의 도메인 전문성 필요
